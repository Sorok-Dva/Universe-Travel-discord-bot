version: '3.7'

services:
  bot:
    container_name: ustar_travel-discord-bot
    image: ustar_travel/discord-bot
    build:
      context: .
      target: build
    restart: always
    tty: true
    command: npm run develop
    volumes:
      - .:/build/
      - node_modules:/build/node_modules
    ports:
      - "${PORT:-4013}:${PORT:-4042}"
    depends_on:
      - db
    networks:
      - default
    env_file: .env
  db:
    container_name: ustart_travel-discord-bot-db
    image: postgis/postgis:12-3.0-alpine
    volumes:
      - db-data:/var/lib/postgresql
    ports:
      - ${DEV_DB_PORT:-4012}:5432
    env_file: .env
    environment:
      PGHOST: ""

networks:
  localnet:

volumes:
  node_modules:
  db-data:
